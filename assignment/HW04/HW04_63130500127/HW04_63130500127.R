library(dplyr)
library(readr)
library(ggplot2)
library(stringr)

csv_books <- read.csv("https://raw.githubusercontent.com/safesit23/INT214-Statistics/main/datasets/prog_book.csv")
View(csv_books)
is.character(csv_books$Reviews)
csv_books$Reviews <- csv_books$Reviews %>% str_remove(',') %>% as.numeric()
glimpse(csv_books)

#??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
count_book <- csv_books %>%  select(Type, Number_Of_Pages) %>% 
  group_by(Type) %>% 
  summarise(max_Page = max(Number_Of_Pages)) %>%
  arrange(desc(max_Page))

#????????????????????????????????????????????????????????????????????????????????? 10 ???????????????????????????
toptitle_book <- csv_books %>% select(Book_title, Price) %>%
  arrange(desc(Price)) %>% head(n = 10)

#??????????????????????????????????????????????????????????????????????????????????????????????????????????????????
Review_book <- csv_books %>% select(Type, Reviews) %>%
    group_by(Type) %>% summarise(amount = sum(Reviews)) %>%
    arrange(desc(amount))


#10 ???????????????????????????????????????????????????????????? rating ??????????????????????????????
topRating_book <- csv_books %>% select(Book_title, Rating) %>%
    arrange(Rating) %>% head(n = 10)
  
#?????????????????????????????????????????????????????????????????????????????????????????????
avg_prices <- csv_books %>% select(Type, Price) %>%
    group_by(Type) %>% summarise(avg_price = mean(Price))

avg_prices

#???????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????? 100 ?????????
avg_page <- csv_books %>% filter(Price > 100) %>% summarise(mean_Page = mean(Number_Of_Pages))
  csv_books %>% summarise(mean(Number_Of_Pages))

#????????????????????????
#1.  
line <- csv_books %>% ggplot(aes(x = Price, y=Number_Of_Pages)) + geom_line(aes(color = Type))
line + geom_smooth()

#2.
bars <- csv_books %>% ggplot(aes(x = as.factor(Type), fill = as.factor(Type))) + geom_bar()+
        scale_fill_brewer(palette = "Set1") +theme(legend.position="none")
bars

